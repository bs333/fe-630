---
title: "FE630 - Midterm Project ~ Q4 - Q6"
subtitle: "I pledge my honor that I have abided by the Stevens Honor System."
author: "Sid Bhatia"
date: "2024-03-26"
output: pdf_document
---

#### Question 4. (15 pts)

```{r}
library(tidyverse)

# Function to read the data
read_data <- function(file_path) {
  data <- read_csv(file_path)
  return(data)
}

# Function to calculate simple returns
calculate_simple_returns <- function(prices) {
  returns <- prices / lag(prices) - 1
  returns <- na.omit(returns)  # Remove NA values resulted from lagging
  return(returns)
}

# Function to annualize returns
annualize_returns <- function(returns) {
  annual_returns <- returns * 252
  return(annual_returns)
}

# Function to compute the covariance matrix
compute_covariance_matrix <- function(returns) {
  Qts <- cov(returns)
  return(Qts)
}

# Set the file path
file_path <- "Midtermdata/data.csv" # Assuming the file extension is .csv for comma-delimited files

# Step 1: Read in the data
data <- read_data(file_path)

# Assuming the first column is the date, and the rest are the prices
dates <- data[[1]] # Extract the first column as dates
prices <- data[-1] # Remove the first column from the data

# Convert the first column to dates if it's not already
dates <- as.Date(as.character(dates), format="%Y%m%d")

# Step 2 and 3: Convert to simple returns and annualize
daily_returns <- calculate_simple_returns(prices)
annual_returns <- annualize_returns(daily_returns)

# Step 5: Compute the covariance matrix
Qts <- compute_covariance_matrix(annual_returns)

# Step 6: Print out the first five rows and columns of the covariance matrix
print(Qts[1:5, 1:5])
```

